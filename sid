#! /usr/bin/env ruby

# sid runner

$:.<< File.join(File.dirname(__FILE__),'./lib')   #add lib directory to path. This way sid can be run in non-gem mode as well.

require "sid"

def main
    puts 'sid: describe your architecture'
    puts "Usage: sid app-ver.sid" if ARGV.length < 1
    sid_input = ARGV[0]

    begin
      print "processing #{sid_input}..."
      sid = Sid::Sid.new sid_input
      input = sid.parse
      ast   = sid.process input
      sid.generate ast
      puts "done."
    rescue Exception => e
      puts "Error occured while processing #{sid_input}: \n\texception: #{e}\n\ttrace: #{e.backtrace}"
      exit 1
    end
end

main

